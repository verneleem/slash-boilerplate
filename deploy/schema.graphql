type Test {
  id: ID
  test: String!
}

type User {
  username: String! @id
  displayName: String
  picture: String
}

type RestrictedByRole
  @auth(
    query: { rule: "{$USER_ROLE: {eq: \"User\"}}" }
    add: { rule: "{$USER_ROLE: {eq: \"User\"}}" }
    update: { rule: "{$USER_ROLE: {eq: \"User\"}}" }
    delete: { rule: "{$USER_ROLE: {eq: \"User\"}}" }
  ) {
  id: ID
  text: String
}

type RestrictedByOwner
  @auth(
    query: {
      rule: "query ($username: String!) { queryRestrictedByOwner { owner(filter: { username: { eq: $username } }) { username } } }"
    }
    add: {
      rule: "query ($username: String!) { queryRestrictedByOwner { owner(filter: { username: { eq: $username } }) { username } } }"
    }
    update: {
      rule: "query ($username: String!) { queryRestrictedByOwner { owner(filter: { username: { eq: $username } }) { username } } }"
    }
    delete: {
      rule: "query ($username: String!) { queryRestrictedByOwner { owner(filter: { username: { eq: $username } }) { username } } }"
    }
  ) {
  id: ID
  text: String
  owner: User!
}

# Dgraph.Authorization {"VerificationKey":"-----BEGIN CERTIFICATE-----\nMIIDDTCCAfWgAwIBAgIJLQRlaTIoZyKuMA0GCSqGSIb3DQEBCwUAMCQxIjAgBgNV\nBAMTGWRldi05M2tlYmZqcy51cy5hdXRoMC5jb20wHhcNMjAxMTI3MDEzMzI2WhcN\nMzQwODA2MDEzMzI2WjAkMSIwIAYDVQQDExlkZXYtOTNrZWJmanMudXMuYXV0aDAu\nY29tMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA1On2d0G5ew0QVUrZ\nR9mGyIgS0cw+IpELf+BuyoKAO+8cRjmQiidN7C8K7lF8cvbdt7wpPXAx07VlxLb9\nGOACcwWjvf0gzcR9doCT1pJ+OkuqE8OKFBKrTTTm9uV/0dQzWbxYRtlFN2Fpopbj\nQCL3jK2muDElc2ZUyZ/y3A/2YXhHbAsMmRh3ZTea1SYW2PdJscSyARIpKs5655vu\nNK+X1ILZmzF6r0JBW8UidUnsCKvUXu6q++Ci6t+t2tMth0Yy1LR3ejqCis5k/K1n\n9UIbtmxwamBh46ZXEkeqH63DPeANBXtWeHZx07/6eYsyTBIKGId07Odt/TrLidNW\nBedAmQIDAQABo0IwQDAPBgNVHRMBAf8EBTADAQH/MB0GA1UdDgQWBBT/KocLZscp\nGIRtJ+S9UMcwKdQ2tzAOBgNVHQ8BAf8EBAMCAoQwDQYJKoZIhvcNAQELBQADggEB\nAHjXFKbHrYJZq2wlpAEBCHc1SmHlDdFf4FcjrjHcyTLnhIufUedpX0wgwmkU8IYF\nit7FklKvbuqZp1xGCzSOPeXzlrzN0+/Dls4VoRuQBJ898wjRioy5xlrbv5MgBbcQ\ns1FQn4NmPtppDr38QbS/gwKgdMNqYHE69zfokzB43R7NqEXzoJXmXdIeiadc02Wv\nI1PT4zLELJh1s+5ouGWOrcjGr9qr8WvV0qVBs+NaIOauf6U1bw7RFWsjk1E0QrMW\ntzSAOmt/e3l45QBpImyTVaeW4bDlEvn3tGwD/ZcTjzGfLPlELpAjD+Wu4v1d1p4a\nWXA8gqQe+RvhMd6FTizbX2A=\n-----END CERTIFICATE-----","Header":"X-My-App-Auth","Namespace":"https://my.app.io/jwt/claims","Algo":"RS256","Audience":["hgLtSE6ETlZHYXLsP30tSkAZDqAVxdEj"]}
